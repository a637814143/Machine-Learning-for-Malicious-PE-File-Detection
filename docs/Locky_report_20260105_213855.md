# 恶意 PE 文件检测报告

- **生成时间**: 2026-01-05 21:38:55
- **文件名**: `Locky.exe`
- **文件路径**: `C:\Python Projects\Machine-Learning-for-Malicious-PE-File-Detection-main\data\pefile\malware\Locky.exe`
- **模型文件**: `C:\Python Projects\Machine-Learning-for-Malicious-PE-File-Detection-main\data\model\model.txt`

## 预测结果

- 模型判定: **恶意**
- 恶意概率 (展示): **63.3731%**
- 原始模型得分: 0.129441
- 判定阈值: 0.0385
- 检测模式: 高精度 (阈值 0.0385，对恶意程序容忍度一般，误判概率小)
- 检测结论: 该程序大概率是恶意程序！

## 模型信心与风险评估

- 综合风险等级: **中等风险**
- 综合风险得分: **5.1 / 10**
- 判定信心: **中等** (与阈值差距 0.0909)

| 主要恶意信号 | 贡献分值 | 说明 |
| --- | --- | --- |
| 高风险 API 调用 | 2.60 | 命中 4 个高风险 API，可能具备注入、下载或加密能力。 |
| 节区熵值异常 | 1.30 | 检测到 1 个高熵节区，疑似包含压缩或加密载荷。 |
| 缺少数字签名 | 1.20 | 文件未发现 Authenticode 签名，可信度下降。 |

**潜在缓解因素**

- 常见系统 API: 大量导入 80 个 GUI/系统相关 API，符合常见应用行为。

## 判定依据

模型认为该文件可能为恶意样本。
- 综合风险评估为 中等风险 (得分 5.1/10)。
- 导入了高风险 API：ADVAPI32.dll!RegSetValueExA, ADVAPI32.dll!RegSetValueW, ADVAPI32.dll!RegCreateKeyExW, ADVAPI32.dll!RegSetValueA。
- 存在高熵节区，可能包含压缩或加密代码：.rsrc (熵 7.18)。
- 缺少数字签名，降低可信度。

## 文件特征概览

- 文件大小: 184320 字节
- 虚拟大小 (SizeOfImage): 4001792
- 是否包含数字签名: 否
- 导入函数数量: 137
- 字符串熵: 5.81
- URL 字符串数量: 0
- 注册表字符串数量: 0
- 字符串密度: 22.92 条/KB
- 节区数量: 4
- 入口节区: 未知

## PE 头部信息

- 机器类型: I386
- 编译时间: 2005-06-20 03:55:03 (UTC)
- 子系统: WINDOWS_GUI
- 代码区大小: 49152
- 头部大小: 4096
- COFF 标志: RELOCS_STRIPPED, EXECUTABLE_IMAGE, LINE_NUMS_STRIPPED, LOCAL_SYMS_STRIPPED, NEED_32BIT_MACHINE

## 高风险 API

- `ADVAPI32.dll!RegSetValueExA`: 修改注册表键值，可能用于持久化。
- `ADVAPI32.dll!RegSetValueW`: 修改注册表键值，可能用于持久化。
- `ADVAPI32.dll!RegCreateKeyExW`: 创建注册表键值，可能用于持久化。
- `ADVAPI32.dll!RegSetValueA`: 修改注册表键值，可能用于持久化。

## 高熵节区

- `.rsrc` — 大小 106496 字节，熵 7.18

## 常见系统 API

- `USER32.dll!DrawIconEx`
- `USER32.dll!IsDialogMessageA`
- `USER32.dll!OffsetRect`
- `USER32.dll!PostThreadMessageW`
- `USER32.dll!DialogBoxParamA`
- `USER32.dll!GetLastActivePopup`
- `USER32.dll!GetGUIThreadInfo`
- `USER32.dll!DrawStateA`
- `USER32.dll!IsWindow`
- `USER32.dll!OpenClipboard`

## 字符串统计

- 可打印字符串数量: 31753
- 平均字符串长度: 7.70
- MZ 标记次数: 1

### 可疑文件路径样本

- \\He\r

### 最长字符串样本

- #0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0
- !This program cannot be run in DOS mode.
- InitializeSecurityDescriptor
- MagnetosphereHyperventilated
- CreateDialogIndirectParamW
- InadvisabilityHeartwarming
- ImmGetCandidateListCountA
- InterrelationshipsMeadows
- LsaQueryInformationPolicy
- SetSecurityDescriptorSacl

### 高频字符分布

| 字符 | 计数 |
| --- | ---: |
| `0` | 2368 |
| `#` | 2012 |
| `e` | 1525 |
| `t` | 1207 |
| `r` | 1092 |
| `i` | 1090 |
| `n` | 1038 |
| `s` | 1027 |
| `a` | 941 |
| `o` | 833 |

## 节区分布概览

| 节区 | 大小 (字节) | 虚拟大小 | 熵 | 关键特征 |
| --- | ---: | ---: | ---: | --- |
| `.rsrc` | 106496 | 0 | 7.18 | 无 |
| `.text` | 49152 | 0 | 6.83 | 无 |
| `.data` | 16384 | 0 | 4.14 | 无 |
| `.rdata` | 8192 | 0 | 5.36 | 无 |

## 导入 DLL 统计

| DLL | 导入函数数量 |
| --- | ---: |
| USER32.dll | 80 |
| ADVAPI32.dll | 38 |
| IMM32.dll | 14 |
| KERNEL32.dll | 3 |
| RASAPI32.dll | 2 |

## 数据目录概览

| 数据目录 | 大小 | RVA |
| --- | ---: | ---: |
| IMPORT_TABLE | 140 | 53972 |
| RESOURCE_TABLE | 102600 | 3895296 |
| IAT | 624 | 53248 |

## 哈希信息

- SHA-256: `bc98c8b22461a2c2631b2feec399208fdc4ecd1cd2229066c2f385caa958daa3`
- MD5: `b06d9dd17c69ed2ae75d9e40b2631b42`
